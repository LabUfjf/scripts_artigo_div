function [RN,L1,IP] = MDFULL(xgrid,P,Q)
%==========================================================================
% Objetivo: * Calcular as Medidas de Distancia com a normalizção FULL
%==========================================================================
P=P(:,1:end-1)';
Q=Q(:,1:end-1)';
dx = diff(xgrid');
%% ========================================================================
% Blocos em comum;
%==========================================================================
PQ.SUB=P-Q;
PQ.SUM=P+Q;
PQ.MULT=P.*Q;

%% ========================================================================
% FAMILIA CORRELATION
%==========================================================================
C = corr(P,Q,'Type','Pearson')'; 
RN.Pearson = C(1,:);


%% ========================================================================
% L1 FAMILY
%==========================================================================
L1.Sorensen = sum(abs(PQ.SUB).*dx)./sum(abs(PQ.SUM).*dx);

%% ========================================================================
% INNER PRODUCT FAMILY
%==========================================================================
IP.Innerproduct = sum(PQ.MULT.*dx);

IPf1 = ((PQ.MULT)./(PQ.SUM));
IPf1(isnan(IPf1)|isinf(IPf1))=0;
IP.Harmonic = 2*sum(IPf1.*dx);

IP.Cosine = (sum(PQ.MULT.*dx)./(sqrt(sum((P.^2).*dx)).*sqrt(sum((Q.^2).*dx))));

end